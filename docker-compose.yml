version: "3.5"

services:
    app: &app
        image: "node:20-alpine"
        entrypoint: "./docker/entrypoint.sh"
        command: "./src/server.js"
        working_dir: "/app"
        environment:
            - NODE_ENV=${APP_ENV:-production}
        volumes:
            - .:/app
        ports:
            - ${APP_PORT:-3001}:3001

    mock:
        <<: *app
        command: "./src/mock-server.js"
        ports:
            - ${MOCK_PORT:-3002}:3002
